<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta name="Description" content="IE9 web automation in C#, VB.Net - get programmatic control over IHTMLElement">
<meta name="Keywords" content="IE9 automation, IE9 macro, IE9 recorder, C# MSHTML, protected mode, cross-frame scripting, IE automation, IHTMLElement, getElementById, getElementsByName">
<title>
		.Net web automation of IHTMLElement in IE6, IE7/IE8/IE9 protected mode 
	</title>
<link href="../CSS/help.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="topicHighlight">
<h2>&nbsp;FindElement - web automation method</h2>
</div>
<h1>
		Connects a web automation <a href="Element.htm
			">Element</a> to an <a href="http://msdn.microsoft.com/en-us/library/aa752279(VS.85).aspx" target="_bank">IHTMLElement</a> that matches a tag-name and verifies a list of <a href="SearchCondition.htm">Search Conditions</a>.
	</h1>
<div class="section">Applies to:</div>
<dl>
<dd><a href="Browser.htm
			">Browser</a>, <a href="Frame.htm
			">Frame</a>, <a href="Element.htm
			">Element</a></dd>
<dd><code>&nbsp;
		var e = obj.FindElement("tag_name", Search conditions);
	</code></dd>
</dl>
<div class="section">Arguments:</div>
<dl>
<dd>
			This method accepts a variable number of <a href="SearchCondition.htm">Search Condition</a> arguments.
			Any HTML attribute is accepted in search conditions. <i>Text</i> is also accepted as attribute in search conditions,
			in this case the <a href="text.htm
			">text</a> of the HTML element is used in search.
			A special zero-based <i>index</i> attribute is available in search condition specifying the ordinal position in the collection of objects generated by the remaining search conditions.
			If no search condition is provided then the first element that matches the <i>tag_name</i> is returned.
		<ul>
<li><em>  </em><code>tag_name</code> is the HTML tag of the element to be found.</li>
</ul>
</dd>
</dl>
<div class="section">Remarks:</div>
<dl>
<dd>
		The method returns an <a href="Element.htm
			">Element</a> IE automation object that matches the search condition arguments and has the specified <i>tag_name</i>.
		It provides programmatic control over the underlying <a href="http://msdn.microsoft.com/en-us/library/aa752279(VS.85).aspx" target="_bank">IHTMLElement</a> native object exposed by IE browser.
		If no element verifies the search conditions, then <i>null</i> is returned.<br>
		In case of an error the method throws a script exception and the <a href="lastError.htm
			">lastError</a> property of the core object is set as follows:
		<ul>
<li><a href="Core.htm#constants">INVALID_ARG_ERROR</a>: if invalid parameters are provided</li>
<li><a href="Core.htm#constants">BROWSER_CONNECTION_LOST_ERROR</a>: if the browser was closed.</li>
<li><a href="Core.htm#constants">FAIL_ERROR</a>: in case of anohter error.</li>
</ul><br>
		The time allocated for search is specified by the <a href="searchTimeout.htm
			">searchTimeout</a> property. The search is affected by <a href="useRegExp.htm
			">useRegExp</a> property.
		If <a href="loadTimeout.htm
			">loadTimeout</a> is not zero, then the method waits the browser objects to be completely loaded in the amount of time specified by the property.
		If the timeout has expired the <a href="lastError.htm
			">lastError</a> property is set to <a href="Core.htm#constants">LOAD_TIMEOUT_ERROR</a>. In this case, if <a href="loadTimeoutIsError.htm
			">loadTimeoutIsError</a> property is true,
		then a IE macro exception is thrown.
		<br><br>
		If the container object is a <a href="Browser.htm
			">Browser</a>, then the method searches the element in all the <i>frame</i> and <i>iframe</i> DOM hierarchy of the browser.
		If the container object is a <a href="Frame.htm
			">Frame</a>, then the method searches the element in all the <i>frame</i> and <i>iframe</i> DOM hierarchy of the container frame.
		If the container object is an <a href="Element.htm
			">Element</a>, then the method searches the element in all HTML DOM hierarchy of the container.
		<br><br>		
		The target HTML element can be inside frames/iframes loaded from various domains. <i>Twebst Web Automation Library</i> bypass all <b>cross-frame scripting security restrictions</b>
		(see: <a href="http://codecentrix.blogspot.com/2007/10/when-ihtmlwindow2getdocument-returns.html" target="_blank">When IHTMLWindow2::get_document returns E_ACCESSDENIED</a> and <a href="http://codecentrix.blogspot.com/2008/02/when-ihtmlwindow2document-throws.html" target="_blank">When IHTMLWindow2.document throws UnauthorizedAccessException</a>).
	</dd>
</dl>
<div class="section">Example:</div>
<dl><dd><pre><code><span STYLE="color: blue">var</span> coreObj = <span STYLE="color: blue">new</span> ActiveXObject(<span STYLE="color: red">"Twebst.Core"</span>);
<span STYLE="color: blue">var</span> browser = coreObj.<a href="StartBrowser.htm
			">StartBrowser</a>(<span STYLE="color: red">"http://www.codecentrix.com/"</span>);

<span STYLE="color: blue">var</span> element = browser.<a href="FindElement.htm
			">FindElement</a>(<span STYLE="color: red">"a"</span>, <span STYLE="color: red">"text=Download"</span>);
element.<a href="Click.htm
			">Click</a>();
		</code></pre></dd></dl>
<div class="section">See also:</div>
<dl>
<dd><a href="Element.htm
			">Element</a> | <a href="FindChildElement.htm
			">FindChildElement</a> | <a href="loadTimeout.htm
			">loadTimeout</a> | <a href="searchTimeout.htm
			">searchTimeout</a> | <a href="useRegExp.htm
			">useRegExp</a></dd>
</dl>
<hr SIZE="1"><small><i><a target="_blank" href="http://www.codecentrix.com">&copy;
						2014 CodeCentrix Software. All rights reserved.
					</a></i></small></body>
</html>
